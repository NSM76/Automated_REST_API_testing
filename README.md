# Pytest_Requests
### Тестирование REST API с помощью Pytest, Requests

### О проекте:
В репозитории содержится проект тестирования **REST API** сайта [PetFriends](https://petfriends.skillfactory.ru/).

### Описание содержимого репозитория.

Файл **api_pf.py** содержит class PetFriends, в котором реализованы все методы взаимодействия с REST API по документации [Swagger](https://petfriends.skillfactory.ru/apidocs/#/).
  1.	*get_api_key* - метод делает запрос к API сервера и возвращает статус запроса и результат в формате JSON с уникальным ключем пользователя, найденного по указанным email и паролем
  2.	*get_list_of_pets* - метод делает запрос к API сервера, возвращает статус запроса и результат в формате JSON со списком найденных питомцев, совпадающих с фильтром. На данный момент 
       фильтр может иметь либо пустое значение - получить список всех питомцев, либо 'my_pets' - получить список собственных питомцев
  3.	*add_new_pet* - метод отправляет (постит) на сервер данные о добавляемом питомце и возвращает статус запроса на сервер и результат в формате JSON с данными добавленного питомца
  4.	*delete_pet* - метод отправляет на сервер запрос на удаление питомца по указанному ID и возвращает статус запроса и результат в формате JSON с текстом уведомления о успешном удалении
  5.	*update_pet_info* - метод отправляет запрос на сервер о обновлении данных питомуца по указанному ID и возвращает статус запроса и result в формате JSON с обновлёнными данными питомца
  6.	*add_new_pet_without_photo* - метод отправляет (постит) на сервер данные о добавляемом питомце без фото и возвращает статус запроса на сервер и результат в формате JSON с данными добавленного питомца
  7.	*add_pet_photo* - метод отправляет (постит) на сервер фото питомца и возвращает статус  запроса на сервер и результат в формате JSON с данными добавленного питомца  
   
 Файл **test_pf.py** содержит тесты и разделен на блоки по классам:
  1.	*TestAddPetsPositive* – содержит позитивные тесты добавления питомца
  
      Тестовые функции:
       1. test_add_new_pet_with_valid_data – проверяем, что можно добавить питомца с корректными данными
       2. test_add_new_pet_without_photo – проверяем, что можно добавить питомца с корректными данными без фото
       
  2.	*TestAddNegative* – содержит негативные тесты добавления питомца
  
      Тестовые функции:
       1. test_add_new_pet_without_age - проверяем, что можно добавить питомца c пустым значением в поле age
       2. test_add_new_pet_with_speсial_symbols_data - проверяем, что можно добавить питомца со спецсимволами в полях name, animal_type, age
       3. test_add_new_pet_without_photo_empty_data - проверяем, что можно добавить питомца с пустыми полями name, animal_type, age без фото
       
  3.	*TestGetList* – содержит тесты получения списка питомцев
   
      Тестовые функции
       1. test_get_all_pets_with_valid_key - проверяем, что запрос всех питомцев c параметром ' ' возвращает не пустой список
       2. test_get_my_pets_with_valid_key – проверяем, что запрос питомцев c параметром 'my_pets' возвращает не пустой список
       3. test_get_all_pets_with_not_valid_key - проверяем, что запрос всех питомцев c невалидным значением параметра filter возвращает ошибку 500
       
  4.	TestUpdatePet – содержит тесты с обновлением данных питомца
  
      Тестовые функции:
       1. test_successful_update_self_pet_info - проверяем возможность обновления информации о питомце
       2. test_add_pet_photo - проверяем, что можно добавить или заменить фото питомца с корректными данными
       
  5.	*TestAuthNegative* – содержит тесты авторизации на сайте с невалидными данными
  
      Тестовые функции:
       1. test_get_api_key_for_not_valid_password - проверяем, что запрос api ключа с невалидным password возвращает статус 403
       2. test_get_api_key_for_not_valid_email - проверяем, что запрос api ключа с невалидным email возвращает статус 403
       3. test_get_api_key_empty_data - проверяем, что запрос api ключа с пустыми email и password возвращает статус 403
       
  6.	*TestDeletePet* – содержит тест на удаление питомца
  
      Тестовая функция:
       1. test_successful_delete_self_pet - проверяем возможность удаления питомца
       
Файл **conftest.py** содержит фиксиуры pytest:
  1.	*get_key* - метод делает запрос к API сервера и возвращает статус запроса и результат в формате  JSON с уникальным ключем пользователя, найденного по указанным email и паролем
  2.	*del_pet* - метод удаляет последнего добавленного питомца, приводя список питомцев в исходное состояние до добавления питомца (TEARDOWN)
  3.	*request_fixture* – метод , используя библиотеку request , делает логирование тестовой функции
  
Файл **settings.py** содержит логины и пароли (валидные и невалидные).

Файл **.env** содержит валидные логин и пароль , для более безопасного хранения(здесь не выложен, можно использовать свои).

Файл **log.txt** содержит логи вызова тестовых функций

Файл **requirements.txt** содержит зависимости проекта (использованные библиотеки)

Файл **pytest.ini** содержит описание пользовательских групп, на которые разбиты тесты с помощью встроенной в pytest фикстуры @pytest.mark.

Папка **images** содержит тестовые данные с фотографиями питомцев.

### Для запуска тестов нужно:
   1.	Устанавить зависимости из файла requirements.txt.
      В командной строке терминала выполнить: pip install -r requirements.txt
      
   2.	Из командной строки запустить тесты: 
   
      1.Вариант: запустить все тесты: 
          python -m pytest -v tests/test_pf.py
      2.Вариант: запустить одну из пользовательских групп, например auth:
          python -m pytest -v -m auth
      3.Вариант: запустить один из тестов, например test_add_pet_photo из класса TestUpdatePet :
          python -m pytest -v tests/test_pf.py::TestUpdatePet::test_add_pet_photo
